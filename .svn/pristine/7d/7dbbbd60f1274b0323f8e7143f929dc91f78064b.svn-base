var express = require('express');
var router = express.Router();

var { log4js } = require('./../utils/log-conf/logger');
var logger = log4js.getLogger('controller');

var InteractionForumsService = require('../service/InteractionForumsService');

router.post('/getInteractionForumsTrendingDetails', async (req, res) => {
    try {
        console.log(req.body);
        var data = await InteractionForumsService.getInteractionForumsTrendingData(req.body);
       // console.log(data);
        res.send(data);
    } catch (error) {
        res.status(404).json(`${error}`);
        logger.fatal(error);
    }
});


router.get('/getCategoryDropDown', async (req, res) => {
    try {

        var data = await InteractionForumsService.getCategoryDropDownList();
        res.send(data);
    } catch (error) {
        res.status(404).json(`${error}`);
        logger.fatal(error);
    }
});


router.post('/getInteractionForumsNewlyAddedDetails', async (req, res) => {
    try {
        console.log(req.body);
        var data = await InteractionForumsService.getInteractionForumsNewlyAddedData(req.body);
        res.send(data);
    } catch (error) {
        res.status(404).json(`${error}`);
        logger.fatal(error);
    }
});


router.post('/getInteractionForumsMostCommentedDetails', async (req, res) => {
    try {
        console.log(req.body);
        var data = await InteractionForumsService.getInteractionForumsMostCommentedData(req.body);
        res.send(data);
    } catch (error) {
        res.status(404).json(`${error}`);
        logger.fatal(error);
    }
});

router.post('/getInteractionForumsDataByID', async (req, res) => {
    try {
        console.log(req.body);
        var data = await InteractionForumsService.getInteractionForumsDataByIdService(req.body);
        res.send(data);
    } catch (error) {
        res.status(404).json(`${error}`);
        logger.fatal(error);
    }
});


router.post('/postAnDiscussion', async (req, res) => {

    try {
        var result = await InteractionForumsService.startDiscussionService(req.body)
        res.json(result);
    } catch (err) {
        logger.fatal(err);
        res.status(404).json(`${err}`);
        // res.status(400).send('failed');
    }
});


router.post('/uploadImageToExistingDiscussion', async (req, res) => {

    try {
        console.log(req.body);
        var result = await InteractionForumsService.uploadNewImage(req.body)


        res.json(result);



    } catch (err) {
        console.log(err);
        logger.fatal(err);
        res.status(404).json(`${err}`);
    }
});

router.post('/savePollingOption', async (req, res) => {

    try {

        var result = await InteractionForumsService.saveOrUpdatePollingOption(req.body)


        res.json(result);



    } catch (err) {
        console.log(err);
        logger.fatal(err);
        res.status(404).json(`${err}`);
    }
});

router.post('/getPollingEmployeeInfo', async (req, res) => {

    try {

        var result = await InteractionForumsService.pollingEmployeeInfo(req.body);

        res.json(result);
    } catch (err) {
        console.log(err);
        logger.fatal(err);
        res.status(404).json(`${err}`);
    }
});

router.post('/likeOrDislike', async (req, res) => {

    try {
        var result = await InteractionForumsService.likeOrDislike(req.body);
        res.json(req.body);

    } catch (err) {
        console.log(err);
        logger.fatal(err);
        res.status(404).json(`${err}`);
    }
});

router.post('/startOrJoinDiscussion', async (req, res) => {

    try {
        var result = await InteractionForumsService.startOrJoinDiscussion(req.body);
        res.json(result);

    } catch (err) {
        console.log(err);
        logger.fatal(err);
        res.status(404).json(`${err}`);
    }
});

module.exports = router;